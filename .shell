#!/bin/sh

shell_add_path() {
	mkdir -p "$1" 2>/dev/null || return
	f=$(cd "$1" && pwd)
	case ":$PATH:" in
		*":$f:"*) :;;
		*) export PATH="$f${PATH:+:$PATH}";;
	esac
	unset f
}

shell_add_manpath() {
	mkdir -p "$1" 2>/dev/null || return
	f=$(cd "$1" && pwd)
	case ":$MANPATH:" in
		*":$f:"*) :;;
		*) export MANPATH="$f${MANPATH:+:$MANPATH}";;
	esac
	unset f
}

shell_reload_sh() {
	[ "$1" ] || return
	[ -d ~/.shell.d ] || return
	for f in ~/.shell.d/?*."${1##*/}"; do
		[ -f "$f" ] && . "$f"
	done
}

shell_reload() {
	shell_add_path /sbin
	shell_add_path /bin
	shell_add_path /usr/sbin
	shell_add_path /usr/bin
	shell_add_path /usr/local/sbin
	shell_add_path /usr/local/bin
	shell_add_path ~/.bin
	shell_add_manpath /usr/share/man
	shell_add_manpath /usr/local/share/man
	shell_reload_sh sh
	shell_reload_sh "$BASH"
	shell_reload_sh "${YASH_VERSION+yash}"
}

shell_reload
